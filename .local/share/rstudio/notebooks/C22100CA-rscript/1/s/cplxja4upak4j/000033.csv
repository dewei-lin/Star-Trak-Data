"0","label = rbind("
"0","  data.frame("
"0","  Production = 101:126, Season = 1),"
"0","  data.frame("
"0","  Production = 127:148, Season = 2),"
"0","  data.frame("
"0","  Production = 149:174, Season = 3),"
"0","  data.frame("
"0","  Production = 175:200, Season = 4),"
"0","  data.frame("
"0","  Production = 201:226, Season = 5),"
"0","  data.frame("
"0","  Production = 227:252, Season = 6),"
"0","  data.frame("
"0","  Production = 253:277, Season = 7))"
"0",""
"0","std_devs <- data %>%"
"0","  select(-`Episode URL`) %>%  "
"0","  summarise(across(everything(), sd, na.rm = TRUE))  "
"0",""
"0","std_devs_long <- pivot_longer(std_devs, cols = everything(), names_to = ""Column"", values_to = ""StdDev"")"
"0",""
"0","top_columns <- std_devs_long %>%"
"0","  arrange(desc(StdDev)) %>%"
"0","  slice(1:500) %>%  "
"0","  pull(Column) "
"0","data_top_columns <- data %>%"
"0","  select(all_of(top_columns))"
"0",""
"0",""
"0",""
"0","data1 <- data %>%"
"0","  mutate("
"0","    EpisodeNumber = str_extract(`Episode URL`, ""\\d+"")"
"0","  ) %>%"
"0","  mutate(EpisodeNumber = as.numeric(EpisodeNumber))  "
"0",""
"0","label_data <- data1 %>%"
"0","  inner_join(label %>% select(Production, Season), by = c(""EpisodeNumber"" = ""Production"")) %>%"
"0","  select(Season)"
"0",""
"0",""
"0","work_d <- cbind(Season = label_data$Season, data_top_columns)"
"0","set.seed(123)"
"0","model_gbm <- gbm("
"0","  data = work_d,"
"0","  formula = Season ~ .,  "
"0","  distribution = ""multinomial"",  "
"0","  n.trees = 100,                "
"0","  interaction.depth = 3,         "
"0","  n.minobsinnode = 10,         "
"0","  shrinkage = 0.1,            "
"0","  verbose = FALSE"
"0",")"
"2","Warning:"
"2"," Setting `distribution = ""multinomial""` is ill-advised as it is currently broken. It exists only for backwards compatibility. Use at your own risk.
"
"0","summary(model_gbm)"
